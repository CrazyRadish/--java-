<html>
<head>
  <title>Sevlet的生命周期（1）（Key）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2545"/>
<h1>Sevlet的生命周期（1）（Key）</h1>

<div>
<span><div><br/></div><div align="justify" style="font-weight: bold; font-size: 26px;"><font color="#010101" face="Times New Roman" size="4"><span style="font-size:14pt"><b>Sevlet</b></span></font><font color="#010101" face="宋体" size="4"><span style="font-size:14pt"><b>的生命周期（重点）</b></span></font></div><div align="justify" style="font-size: 26px;"><span style="font-size: 14pt;"><span style="font-family: 宋体;"><span style="color: rgb(1, 1, 1);"><b><a href="Sevlet的生命周期（1）（Key）_files/servlet的生命周期.mdl"><img src="Sevlet的生命周期（1）（Key）_files/2a1234b00e37c655792a90c54368bdd2.png" alt="servlet的生命周期.mdl"></a><span style="color: rgb(54, 101, 238);">ration rose 时序图</span></b></span></span></span></div><div><h2 align="justify"><font color="#010101" face="宋体"><span style="font-size:12pt"><b>         4.1 引入</b></span></font></h2><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     Servlet</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的生命周期： servlet类对象什么时候创建，什么时候调用什么方法，什么时候销毁。</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     </span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">以前的对象： new Student（）； stu.study();   stu=null;</span></font></div><div align="justify" style="min-height: 12pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">       </span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     Servlet</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">程序的生命周期由</span></font><font color="#FF0000" face="Times New Roman" size="2"><span style="font-size:10pt">tomcat</span></font><font color="#FF0000" face="宋体" size="2"><span style="font-size:10pt">服务器控制</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">的！！！！</span></font></div><div align="justify" style="min-height: 12pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                            </span></font></div><h2 align="justify"><font color="#010101" face="宋体"><span style="font-size:12pt"><b>         4.2 Servlet重要的四个生命周期方法</b></span></font></h2><div align="justify" style="min-height: 13pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     </span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">构造方法： 创建servlet对象的时候调用。默认情况下，第一次访问servlet的时候创建servlet对象</span></font><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                                            </span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">只调用1次。证明servlet对象在tomcat是单实例的。</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     init</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">方法： 创建完servlet对象的时候调用。只调用1次。</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     service</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">方法： 每次发出请求时调用。调用n次。</span></font></div><div align="justify" style="min-height: 14pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                     destroy</span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">方法： 销毁servlet对象的时候调用。停止服务器或者重新部署web应用时销毁servlet对象。</span></font></div><div align="justify" style="min-height: 13pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                                                 </span></font><font color="#010101" face="宋体" size="2"><span style="font-size:10pt">只调用1次。</span></font></div><div align="justify" style="min-height: 12pt;"><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">                            </span></font></div></div><div><br/></div><div align="justify" style="font-weight: bold; font-size: 20px;"><font color="#010101" face="宋体"><span style="font-size:12pt"><b>        伪代码演示servlet的生命周期</b></span></font></div><div align="justify" style="min-height: 14pt;"><div><font color="#010101" face="Times New Roman" size="2"><span style="font-size:10pt">         </span></font></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>   <span style="color: rgb(255, 0, 0);"><i> </i> Tomtcat内部代码运行：</span></div><div><span style="color: rgb(255, 0, 0);">                     1）通过映射找到到servlet-class的内容，字符串： gz.itcast.a_servlet.FirstServlet</span></div><div><span style="color: rgb(255, 0, 0);">            2）通过反射构造FirstServlet对象</span></div><div><span style="color: rgb(255, 0, 0);">                    2.1 得到字节码对象</span></div><div><span style="color: rgb(255, 0, 0);">                    Class clazz = class.forName(&quot;gz.itcast.a_servlet.FirstServlet&quot;);</span></div><div><span style="color: rgb(255, 0, 0);">                    2.2 调用无参数的构造方法来构造对象</span></div><div><span style="color: rgb(255, 0, 0);">                    Object obj = clazz.newInstance();     ---1.servlet的构造方法被调用</span></div><div><span style="color: rgb(255, 0, 0);">            3）创建ServletConfig对象，通过反射调用init方法</span></div><div><span style="color: rgb(255, 0, 0);">                    3.1 得到方法对象</span></div><div><span style="color: rgb(255, 0, 0);">                    Method m = clazz.getDeclareMethod(&quot;init&quot;,ServletConfig.class);</span></div><div><span style="color: rgb(255, 0, 0);">                    3.2 调用方法</span></div><div><span style="color: rgb(255, 0, 0);">                    m.invoke(obj,config);             --2.servlet的init方法被调用</span></div><div><span style="color: rgb(255, 0, 0);">            4）创建request，response对象，通过反射调用service方法</span></div><div><span style="color: rgb(255, 0, 0);">                    4.1 得到方法对象</span></div><div><span style="color: rgb(255, 0, 0);">                    Methodm m =clazz.getDeclareMethod(&quot;service&quot;,HttpServletRequest.class,HttpServletResponse.class);</span></div><div><span style="color: rgb(255, 0, 0);">                    4.2 调用方法</span></div><div><span style="color: rgb(255, 0, 0);">                    m.invoke(obj,request,response);  --3.servlet的service方法被调用</span></div><div><span style="color: rgb(255, 0, 0);">            5）当tomcat服务器停止或web应用重新部署，通过反射调用destroy方法</span></div><div><span style="color: rgb(255, 0, 0);">                    5.1 得到方法对象</span></div><div><span style="color: rgb(255, 0, 0);">                    Method m = clazz.getDeclareMethod(&quot;destroy&quot;,null);</span></div><div><span style="color: rgb(255, 0, 0);">                    5.2 调用方法</span></div><div><span style="color: rgb(255, 0, 0);">                    m.invoke(obj,null);            --4.servlet的destroy方法被调用</span></div><div><span style="color: rgb(255, 0, 0);"><br/></span></div></div><div><span style="font-family: 'Times New Roman';"><span style="color: rgb(1, 1, 1);"><br/></span></span></div></div></span>
</div></body></html> 