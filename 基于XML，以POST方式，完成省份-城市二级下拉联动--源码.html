<html>
<head>
  <title>基于XML，以POST方式，完成省份-城市二级下拉联动--源码</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1711"/>
<h1>基于XML，以POST方式，完成省份-城市二级下拉联动--源码</h1>

<div>
<span><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><b><span style="color: rgb(255, 0, 0);">Province.jsp</span></b></div><div>&lt;%@ page language=&quot;java&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</div><div>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;</div><div>&lt;html&gt;</div><div>  &lt;head&gt;</div><div>    &lt;title&gt;基于XML，以POST方式，完成省份-城市二级下拉联动&lt;/title&gt;</div><div>    &lt;script type=&quot;text/javascript&quot; src=&quot;js/ajax.js&quot;&gt;&lt;/script&gt;</div><div>  &lt;/head&gt;</div><div>  &lt;body&gt;</div><div><br/></div><div>      &lt;select id=&quot;provinceID&quot; style=&quot;width:111px&quot;&gt;</div><div>            &lt;option&gt;选择省份&lt;/option&gt;</div><div>            &lt;option&gt;湖南&lt;/option&gt;</div><div>            &lt;option&gt;广东&lt;/option&gt;</div><div>      &lt;/select&gt;<br/></div><div>      &amp;nbsp;&amp;nbsp;&amp;nbsp;</div><div>      &lt;select id=&quot;cityID&quot; style=&quot;width:111px&quot;&gt;</div><div>            &lt;option&gt;选择城市&lt;/option&gt;</div><div>      &lt;/select&gt;<br/></div><div><br/></div><div>      &lt;script type=&quot;text/javascript&quot;&gt;</div><div>            //定位省份下拉框，同时添加内容改变事件</div><div>            document.getElementById(&quot;provinceID&quot;).onchange = function(){</div><div>                  //清空城市下拉框中的内容，除第一项外</div><div>                  var cityElement = document.getElementById(&quot;cityID&quot;);</div><div>                  cityElement.options.length = 1;</div><div>                  //获取选中option标签的索引号，从0开始</div><div>                  var index = this.selectedIndex;</div><div>                  //定位选中的option标签</div><div>                  var optionElement = this[index];</div><div>                  //获取选中的option标签中的内容，即省份</div><div>                  var province = optionElement.innerHTML;</div><div>                  //如果选中的内容不是&quot;选择省份&quot;</div><div>                  if(&quot;选择省份&quot; != province){</div><div>                        //NO1)</div><div>                        var ajax = createAJAX();</div><div>                        //NO2)</div><div>                        var method = &quot;POST&quot;;</div><div>                        var url = &quot;${pageContext.request.contextPath}/ProvinceCityServlet?time=&quot;+new Date().getTime();</div><div>                        ajax.open(method,url);</div><div>                        //设置AJAX请求头</div><div>                        ajax.setRequestHeader(&quot;content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);</div><div>                        //NO3)</div><div>                        var content = &quot;province=&quot; + province;</div><div>                        ajax.send(content);</div><div><br/></div><div>                        //---------------------------------等待</div><div><br/></div><div>                        //NO4)</div><div>                        ajax.onreadystatechange = function(){</div><div>                              if(ajax.readyState == 4){</div><div>                                    if(ajax.status == 200){</div><div>                                          //NO5)从AJAX异步对象中获取服务器响应的xml文档</div><div>                                          var xmlDocument = ajax.responseXML;</div><div><br/></div><div>                                          //NO6)按照DOM规则，解析XML文档</div><div><br/></div><div>                                          var cityElementArray = xmlDocument.getElementsByTagName(&quot;city&quot;);</div><div>                                          var size = cityElementArray.length;</div><div>                                          for(var i=0;i&lt;size;i++){</div><div>                                                //innerHTML只能用在html/jsp中，不能用在xml中</div><div>                                                var city = cityElementArray[i].firstChild.nodeValue;</div><div>                                                //&lt;option&gt;&lt;/option&gt;</div><div>                                                var optionElement = document.createElement(&quot;option&quot;);</div><div>                                                //&lt;option&gt;广州&lt;/option&gt;</div><div>                                                optionElement.innerHTML = city;</div><div>                                                //&lt;select&gt;&lt;option&gt;广州&lt;/option&gt;&lt;/select&gt;</div><div>                                                cityElement.appendChild(optionElement);</div><div>                                          }</div><div>                                    }</div><div>                              }</div><div>                        }</div><div>                  }</div><div>            }</div><div>      &lt;/script&gt;</div><div><br/></div><div>  &lt;/body&gt;</div><div>&lt;/html&gt;</div><div> </div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 12px; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);"><div><b>provinceCityServlet.java</b></div><div><b><span style="color: rgb(255, 0, 0);">package cn.itcast.javaee.js.provincecity;</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">import java.io.IOException;</span></b></div><div><b><span style="color: rgb(255, 0, 0);">import java.io.PrintWriter;</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">import javax.servlet.ServletException;</span></b></div><div><b><span style="color: rgb(255, 0, 0);">import javax.servlet.http.HttpServlet;</span></b></div><div><b><span style="color: rgb(255, 0, 0);">import javax.servlet.http.HttpServletRequest;</span></b></div><div><b><span style="color: rgb(255, 0, 0);">import javax.servlet.http.HttpServletResponse;</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">/**</span></b></div><div><b><span style="color: rgb(255, 0, 0);"> * 基于XML，以POST方式，完成省份-城市二级下拉联动</span></b></div><div><b><span style="color: rgb(255, 0, 0);"> * @author Radish</span></b></div><div><b><span style="color: rgb(255, 0, 0);"> */</span></b></div><div><b><span style="color: rgb(255, 0, 0);">public class ProvinceCityServlet extends HttpServlet {</span></b></div><div><b><span style="color: rgb(255, 0, 0);">    public void doPost(HttpServletRequest request, HttpServletResponse response)throws ServletException, IOException {</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        request.setCharacterEncoding(&quot;UTF-8&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        String province = request.getParameter(&quot;province&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">        //通知AJAX异步对象，服务器响应的数据为xml格式的</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        response.setContentType(&quot;text/xml;charset=UTF-8&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        //获取字符输出流</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        PrintWriter pw = response.getWriter();</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">        pw.write(&quot;&lt;?xml version='1.0' encoding='UTF-8'?&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        pw.write(&quot;&lt;root&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">        if(&quot;广东&quot;.equals(province)){</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;广州&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;深圳&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;中山&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        }else if(&quot;湖南&quot;.equals(province)){</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;长沙&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;株洲&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;湘潭&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">            pw.write(&quot;&lt;city&gt;岳阳&lt;/city&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        }</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);">        pw.write(&quot;&lt;/root&gt;&quot;);</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        pw.flush();</span></b></div><div><b><span style="color: rgb(255, 0, 0);">        pw.close();</span></b></div><div><b><span style="color: rgb(255, 0, 0);">    }</span></b></div><div><b><span style="color: rgb(255, 0, 0);">}</span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div><div><b><span style="color: rgb(255, 0, 0);"><br/></span></b></div></div><div><br/></div></span>
</div></body></html> 